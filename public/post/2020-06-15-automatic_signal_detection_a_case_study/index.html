<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Automatic signal detection: a case study - Coded bioacoustics</title>

  <meta name="description" content="Mar-2024: Note that the R package ohun for optimizing sound event detection is now available which provides an improved version of the methods shown in this post Some recent additions to warbleR aim to simplify the automatic detection of signals. The current post details these additions with a study case detecting inquiry calls of Spix&rsquo;s disc-winged bats (Thyroptera tricolor).
Inquiry calls were recorded while the bats were flying in a flight cage."><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Coded bioacoustics",
    
    "url": "marce10.github.io\/coded_bioacustics\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "marce10.github.io\/coded_bioacustics\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "marce10.github.io\/coded_bioacustics\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "marce10.github.io\/coded_bioacustics\/post\/2020-06-15-automatic_signal_detection_a_case_study\/",
          "name": "Automatic signal detection a case study"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Marcelo Araya-Salas"
  },
  "headline": "Automatic signal detection: a case study",
  "description" : "Mar-2024: Note that the R package ohun for optimizing sound event detection is now available which provides an improved version of the methods shown in this post Some recent additions to warbleR aim to simplify the automatic detection of signals. The current post details these additions with a study case detecting inquiry calls of Spix\u0026rsquo;s disc-winged bats (Thyroptera tricolor).\nInquiry calls were recorded while the bats were flying in a flight cage.",
  "inLanguage" : "en",
  "wordCount":  2475 ,
  "datePublished" : "2020-05-15T00:00:00",
  "dateModified" : "2020-05-15T00:00:00",
  "image" : "marce10.github.io\/coded_bioacustics\/img\/blog_sticker_v2.png",
  "keywords" : [ "sound event detection" ],
  "mainEntityOfPage" : "marce10.github.io\/coded_bioacustics\/post\/2020-06-15-automatic_signal_detection_a_case_study\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "marce10.github.io\/coded_bioacustics\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "marce10.github.io\/coded_bioacustics\/img\/blog_sticker_v2.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Automatic signal detection: a case study" />
<meta property="og:description" content="Mar-2024: Note that the R package ohun for optimizing sound event detection is now available which provides an improved version of the methods shown in this post Some recent additions to warbleR aim to simplify the automatic detection of signals. The current post details these additions with a study case detecting inquiry calls of Spix&rsquo;s disc-winged bats (Thyroptera tricolor).
Inquiry calls were recorded while the bats were flying in a flight cage.">
<meta property="og:image" content="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" />
<meta property="og:url" content="marce10.github.io/coded_bioacustics/marce10.github.io/coded_bioacustics/post/2020-06-15-automatic_signal_detection_a_case_study/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Coded bioacoustics" />

  <meta name="twitter:title" content="Automatic signal detection: a case study" />
  <meta name="twitter:description" content="Mar-2024: Note that the R package ohun for optimizing sound event detection is now available which provides an improved version of the methods shown in this post Some recent additions to warbleR aim â€¦">
  <meta name="twitter:image" content="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@Marcelo_Araya_Salas" />
  <meta name="twitter:creator" content="@Marcelo_Araya_Salas" />
  <link href='marce10.github.io/coded_bioacustics/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.121.2">
  <link rel="alternate" href="marce10.github.io/coded_bioacustics/index.xml" type="application/rss+xml" title="Coded bioacoustics"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/highlight.min.css" /><link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-RZVLSR0L9P"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-RZVLSR0L9P', { 'anonymize_ip': false });
}
</script>

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="marce10.github.io/coded_bioacustics/">Coded bioacoustics</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Samples</a>
              <div class="navlinks-children">
                
                  <a href="/marce10.github.io/coded_bioacustics/post/2017-03-07-bigimg-sample">Big Image Sample</a>
                
                  <a href="/marce10.github.io/coded_bioacustics/post/2017-03-05-math-sample">Math Sample</a>
                
                  <a href="/marce10.github.io/coded_bioacustics/post/2016-03-08-code-sample">Code Sample</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/marce10.github.io/coded_bioacustics/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/marce10.github.io/coded_bioacustics/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Coded bioacoustics" href="marce10.github.io/coded_bioacustics/">
            <img class="avatar-img" src="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" alt="Coded bioacoustics" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Automatic signal detection: a case study</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on May 15, 2020
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;12&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;2475&nbsp;words
  
  
    
      
        &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Marcelo Araya-Salas
      
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <div class="alert alert-info">
<center><b>Mar-2024:</b> Note that the <a href="https://docs.ropensci.org/ohun/">R package ohun</a> for optimizing sound event detection is now available which provides an improved version of the methods shown in this post  
</div>
<p>Some recent additions to <a href="https://cran.r-project.org/package=warbleR">warbleR</a> aim to simplify the automatic detection of signals. The current post details these additions with a study case detecting inquiry calls of Spix&rsquo;s disc-winged bats (<em>Thyroptera tricolor</em>).</p>
<p>Inquiry calls were recorded while the bats were flying in a flight cage. Recordings were made on four channels, each one from a different mic. Mics were about 1m apart from each other. So the four channels from a recording event represent slightly different registers of the same calls. This is an important characteristic of the data that will be taken into account in the analysis. Recordings were made as part of an ongoing study on indvidual variation in vocal activity at the <a href="https://www.batcr.com">Chaverri Lab</a>.</p>
<p>To run this post you will need  <a href="https://cran.r-project.org/package=warbleR">warbleR</a> 1.1.24 (currently as the developmental version on github). It can be installed like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># From github</span>
</span></span><span class="line"><span class="cl"><span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&#34;maRce10/warbleR&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load warbleR</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">warbleR</span><span class="p">)</span>
</span></span></code></pre></div><p>Recordings of Spix&rsquo;s disc-winged bat inquiry calls can be downloaded like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># set temporary directory</span>
</span></span><span class="line"><span class="cl"><span class="nf">setwd</span><span class="p">(</span><span class="nf">tempdir</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ids of figshare files to download</span>
</span></span><span class="line"><span class="cl"><span class="n">ids</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">22496621</span><span class="p">,</span> <span class="m">22496585</span><span class="p">,</span> <span class="m">22495355</span><span class="p">,</span> <span class="m">22495397</span><span class="p">,</span> <span class="m">22473986</span><span class="p">,</span> <span class="m">22474022</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="m">22474586</span><span class="p">,</span> <span class="m">22474628</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nms</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;1_ch2.wav&#34;</span><span class="p">,</span> <span class="s">&#34;2_ch2.wav&#34;</span><span class="p">,</span> <span class="s">&#34;2_ch1.wav&#34;</span><span class="p">,</span> <span class="s">&#34;1_ch1.wav&#34;</span><span class="p">,</span> <span class="s">&#34;1_ch4.wav&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">         <span class="s">&#34;2_ch4.wav&#34;</span><span class="p">,</span> <span class="s">&#34;1_ch3.wav&#34;</span><span class="p">,</span> <span class="s">&#34;2_ch3.wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">for</span><span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">ids</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> <span class="nf">download.file</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;https://ndownloader.figshare.com/files/&#34;</span><span class="p">,</span> <span class="n">ids[i]</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl"> <span class="n">destfile</span> <span class="o">=</span> <span class="n">nms[i]</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="cross-correlation-based-detection">Cross-correlation based detection</h2>
<p>Cross-correlation can be used to detect highly stereotyped signals like the inquiry calls of Spix&rsquo;s disc-winged bats. Cross-correlation detection uses an acoustic template to find similar signals across sound files. Hence, the first step is
creating a template, which can be easily done by making a selection table with the time location of an example inquiry call (location was determined by scrolling over the spectrogram using <a href="https://www.audacityteam.org">Audacity</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get a call template </span>
</span></span><span class="line"><span class="cl"><span class="n">templt</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">sound.files</span> <span class="o">=</span> <span class="s">&#34;2_ch2.wav&#34;</span><span class="p">,</span> <span class="n">selec</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">channel</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="m">33.720</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="m">33.756</span><span class="p">,</span> <span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># read template as wave object</span>
</span></span><span class="line"><span class="cl"><span class="n">wv</span> <span class="o">&lt;-</span> <span class="nf">read_wave</span><span class="p">(</span><span class="n">templt</span><span class="p">,</span> <span class="n">from</span> <span class="o">=</span> <span class="n">templt</span><span class="o">$</span><span class="n">start</span> <span class="o">-</span> <span class="m">0.02</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">templt</span><span class="o">$</span><span class="n">end</span> <span class="o">+</span> <span class="m">0.02</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">spectro</span><span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">wl</span> <span class="o">=</span> <span class="m">300</span><span class="p">,</span> <span class="n">ovlp</span> <span class="o">=</span> <span class="m">80</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">osc</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">35</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">        <span class="n">noisereduction</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  
      
      
  <picture>
  <img class="img-fluid" src="marce10.github.io/coded_bioacustics/img/template-1.png?v=9a5e11cbb2a185d5bb06f1c77680857f" alt="template_1" loading="lazy" height="367px" width="595px" />
</picture>
</p>
<p>The second step requires making a selection table containing both the sound files in which to look for the template and the template itself:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># whole recordings selection table</span>
</span></span><span class="line"><span class="cl"><span class="n">sel_tab_1</span> <span class="o">&lt;-</span> <span class="nf">selection_table</span><span class="p">(</span><span class="n">whole.recs</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## all selections are OK
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># add template selection</span>
</span></span><span class="line"><span class="cl"><span class="n">sel_tab</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">templt</span><span class="p">,</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">sel_tab_1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sel_tab</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##   sound.files selec channel start      end
</span></span><span class="line"><span class="cl">## 1   2_ch2.wav     2       1 33.72 33.75600
</span></span><span class="line"><span class="cl">## 2   1_ch1.wav     1       1  0.00 48.88986
</span></span><span class="line"><span class="cl">## 3   1_ch2.wav     1       1  0.00 48.88986
</span></span><span class="line"><span class="cl">## 4   1_ch3.wav     1       1  0.00 48.88986
</span></span><span class="line"><span class="cl">## 5   1_ch4.wav     1       1  0.00 48.88986
</span></span><span class="line"><span class="cl">## 6   2_ch1.wav     1       1  0.00 49.54521
</span></span><span class="line"><span class="cl">## 7   2_ch2.wav     1       1  0.00 49.54521
</span></span><span class="line"><span class="cl">## 8   2_ch3.wav     1       1  0.00 49.54521
</span></span><span class="line"><span class="cl">## 9   2_ch4.wav     1       1  0.00 49.54521
</span></span></code></pre></div><p>Finally, we must tell R which selection will be used as templates and where to look for them. To do this we need a two column matrix to indicate which selections should be used as templates (first column) and on which selections (or sound files) they will be detected (second column). If the name includes the selection number (&lsquo;selec&rsquo; column added at the end of the sound file name, e.g. &ldquo;2_ch2.wav-2&rdquo;) only the sound file segment specified in the selection will be used. If only the sound file name is included the function will look for the template across the entire sound file. In this case we want to use the first selection as template and run it over the entire sound files in &lsquo;sel_tab&rsquo;:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># pairwise comparison matrix</span>
</span></span><span class="line"><span class="cl"><span class="n">comp_mat</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">sel_tab</span><span class="o">$</span><span class="n">sound.files[1]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">sel_tab</span><span class="o">$</span><span class="n">selec[1]</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#34;-&#34;</span><span class="p">),</span> <span class="n">sel_tab</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># look at it</span>
</span></span><span class="line"><span class="cl"><span class="n">comp_mat</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##       [,1]          [,2]       
</span></span><span class="line"><span class="cl">##  [1,] &#34;2_ch2.wav-2&#34; &#34;2_ch2.wav&#34;
</span></span><span class="line"><span class="cl">##  [2,] &#34;2_ch2.wav-2&#34; &#34;1_ch1.wav&#34;
</span></span><span class="line"><span class="cl">##  [3,] &#34;2_ch2.wav-2&#34; &#34;1_ch2.wav&#34;
</span></span><span class="line"><span class="cl">##  [4,] &#34;2_ch2.wav-2&#34; &#34;1_ch3.wav&#34;
</span></span><span class="line"><span class="cl">##  [5,] &#34;2_ch2.wav-2&#34; &#34;1_ch4.wav&#34;
</span></span><span class="line"><span class="cl">##  [6,] &#34;2_ch2.wav-2&#34; &#34;2_ch1.wav&#34;
</span></span><span class="line"><span class="cl">##  [7,] &#34;2_ch2.wav-2&#34; &#34;2_ch2.wav&#34;
</span></span><span class="line"><span class="cl">##  [8,] &#34;2_ch2.wav-2&#34; &#34;2_ch3.wav&#34;
</span></span><span class="line"><span class="cl">##  [9,] &#34;2_ch2.wav-2&#34; &#34;2_ch4.wav&#34;
</span></span></code></pre></div><p>We are ready to detect signals using cross-correlation. In this example we use Mel-frequency cepstral coefficient cross-correlation (argument <code>type = &quot;mfcc&quot;</code>), which seems to work fine on these signals and tends to run faster than the more traditional Fourier transform spectrogram cross-correlation approach (but feel free to try it: <code>type = &quot;spcc&quot;</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run cross-correlation</span>
</span></span><span class="line"><span class="cl"><span class="n">xc_output</span> <span class="o">&lt;-</span> <span class="nf">xcorr</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">sel_tab</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;list&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">compare.matrix</span> <span class="o">=</span> <span class="n">comp_mat</span><span class="p">,</span> <span class="n">bp</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">12</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;mfcc&#34;</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>Note that the output was set to &ldquo;list&rdquo;, which includes a data frame with correlation scores by time for all sound files. This can be directly input into <code>lspec()</code> to visually explore the accuracy of the detection. The function <code>lspec()</code> plots the spectrogram of entire sound files split into multiple rows. However, if the output of <code>xcorr()</code> (or <code>find_peaks()</code>, see below) is supplied the function also plots a correlation score contour row below the spectrograms:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">lspec</span><span class="p">(</span><span class="n">xc_output</span><span class="p">,</span> <span class="n">sxrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="n">fast.spec</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">      <span class="n">res</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  
      
      
  <picture>
  <img class="img-fluid" src="marce10.github.io/coded_bioacustics/img/xcorr_lspec.gif?v=b02f9c5a7230ac0a6f851d24e1dd6586" alt="gif1" loading="lazy" height="595px" width="770px" />
</picture>
</p>
<p>In this case a good detection routine should produce peaks in the score countour in the places where the inquiry calls are found. So it looks like it worked.</p>
<p>The output from <code>xcorr()</code> can also be taken by the function <code>find_peaks()</code> to detect signals. This function finds all instances in which the correlation scores goes above a certain threshold (&lsquo;cutoff&rsquo; argument, within 0-1 range). In this case a threshold of 0.4 seems to work well:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pks</span> <span class="o">&lt;-</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="n">xc.output</span> <span class="o">=</span> <span class="n">xc_output</span><span class="p">,</span> <span class="n">cutoff</span> <span class="o">=</span> <span class="m">0.4</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;list&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Again, if we used <code>output= &quot;list&quot;</code> in <code>find_peaks()</code>, the output can be plotted by <code>lspec()</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">lspec</span><span class="p">(</span><span class="n">pks</span><span class="p">,</span> <span class="n">sxrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="n">fast.spec</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">      <span class="n">res</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  
      
      
  <picture>
  <img class="img-fluid" src="marce10.github.io/coded_bioacustics/img/findpeaks_lspec.gif?v=33d6586b60cc46245d68bb6d60fad3c6" alt="gif2" loading="lazy" height="595px" width="770px" />
</picture>
</p>
<p>Detections look fine. However, we ran the analysis on all four channels for each sound file. So it&rsquo;s very likely that some signals were detected more than once. We need to remove those duplicates. We can use the function <code>ovlp_sels()</code>to find them:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># extract selection table from find_peaks output</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span> <span class="o">&lt;-</span> <span class="n">pks</span><span class="o">$</span><span class="n">selection.table</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># rename sound files column so all channels belonging to the </span>
</span></span><span class="line"><span class="cl"><span class="c1"># same sound file have the same sound file name momentarily</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span><span class="o">$</span><span class="n">org.sound.files</span> <span class="o">&lt;-</span> <span class="n">dup_peaks</span><span class="o">$</span><span class="n">sound.files</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;_ch[[:digit:]]&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">dup_peaks</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get overlapping sels</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span> <span class="o">&lt;-</span> <span class="nf">ovlp_sels</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">dup_peaks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get original sound files names back  </span>
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="n">dup_peaks</span><span class="o">$</span><span class="n">org.sound.files</span>
</span></span></code></pre></div><p>The function tags all overlapping selections with a unique label found in the column &lsquo;ovlp.sels&rsquo; (last column):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dup_peaks</span>
</span></span></code></pre></div><div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:900px;  font-size: 14px; margin-left: auto; margin-right: auto;" class="table table-striped"><table>
 <thead>
  <tr>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> sound.files </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> selec </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> start </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> end </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> template </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> time </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> score </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> bottom.freq </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> top.freq </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> org.sound.files </th>
   <th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;"> ovlp.sels </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 24.98930 </td>
   <td style="text-align:center;"> 25.02530 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 25.00730 </td>
   <td style="text-align:center;"> 0.6983542 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 26.59241 </td>
   <td style="text-align:center;"> 26.62841 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 26.61041 </td>
   <td style="text-align:center;"> 0.7479324 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 30.00148 </td>
   <td style="text-align:center;"> 30.03748 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 30.01948 </td>
   <td style="text-align:center;"> 0.5576180 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 33.71686 </td>
   <td style="text-align:center;"> 33.75286 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.73486 </td>
   <td style="text-align:center;"> 0.8860906 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 37.74650 </td>
   <td style="text-align:center;"> 37.78250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 37.76450 </td>
   <td style="text-align:center;"> 0.6860341 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 39.30186 </td>
   <td style="text-align:center;"> 39.33786 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 39.31986 </td>
   <td style="text-align:center;"> 0.8321235 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 14 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 7 </td>
   <td style="text-align:center;"> 24.99328 </td>
   <td style="text-align:center;"> 25.02928 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 25.01128 </td>
   <td style="text-align:center;"> 0.7910162 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 8 </td>
   <td style="text-align:center;"> 26.59638 </td>
   <td style="text-align:center;"> 26.63238 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 26.61438 </td>
   <td style="text-align:center;"> 0.8205698 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 9 </td>
   <td style="text-align:center;"> 30.00546 </td>
   <td style="text-align:center;"> 30.04146 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 30.02346 </td>
   <td style="text-align:center;"> 0.7546002 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 33.72084 </td>
   <td style="text-align:center;"> 33.75684 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.73884 </td>
   <td style="text-align:center;"> 0.9920144 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> 37.74650 </td>
   <td style="text-align:center;"> 37.78250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 37.76450 </td>
   <td style="text-align:center;"> 0.6860341 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 12 </td>
   <td style="text-align:center;"> 39.30584 </td>
   <td style="text-align:center;"> 39.34184 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 39.32384 </td>
   <td style="text-align:center;"> 0.8643382 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 14 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 18.55341 </td>
   <td style="text-align:center;"> 18.58941 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 18.57141 </td>
   <td style="text-align:center;"> 0.5914480 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 23.91575 </td>
   <td style="text-align:center;"> 23.95175 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 23.93375 </td>
   <td style="text-align:center;"> 0.8918387 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 27.89376 </td>
   <td style="text-align:center;"> 27.92976 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 27.91176 </td>
   <td style="text-align:center;"> 0.4598352 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 28.22791 </td>
   <td style="text-align:center;"> 28.26391 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 28.24591 </td>
   <td style="text-align:center;"> 0.4859460 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 32.17807 </td>
   <td style="text-align:center;"> 32.21407 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 32.19607 </td>
   <td style="text-align:center;"> 0.6110752 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 33.54650 </td>
   <td style="text-align:center;"> 33.58250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.56450 </td>
   <td style="text-align:center;"> 0.4629314 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
   <td style="text-align:center;"> 40.54381 </td>
   <td style="text-align:center;"> 40.57981 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 40.56181 </td>
   <td style="text-align:center;"> 0.6068854 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 18.55341 </td>
   <td style="text-align:center;"> 18.58941 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 18.57141 </td>
   <td style="text-align:center;"> 0.5914480 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 23.91575 </td>
   <td style="text-align:center;"> 23.95175 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 23.93375 </td>
   <td style="text-align:center;"> 0.8918387 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 27.89376 </td>
   <td style="text-align:center;"> 27.92976 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 27.91176 </td>
   <td style="text-align:center;"> 0.4598352 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 28.22791 </td>
   <td style="text-align:center;"> 28.26391 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 28.24591 </td>
   <td style="text-align:center;"> 0.4859460 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 32.17807 </td>
   <td style="text-align:center;"> 32.21407 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 32.19607 </td>
   <td style="text-align:center;"> 0.6110752 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 18.55341 </td>
   <td style="text-align:center;"> 18.58941 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 18.57141 </td>
   <td style="text-align:center;"> 0.5914480 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 23.91575 </td>
   <td style="text-align:center;"> 23.95175 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 23.93375 </td>
   <td style="text-align:center;"> 0.8918387 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 27.89376 </td>
   <td style="text-align:center;"> 27.92976 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 27.91176 </td>
   <td style="text-align:center;"> 0.4598352 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 28.22791 </td>
   <td style="text-align:center;"> 28.26391 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 28.24591 </td>
   <td style="text-align:center;"> 0.4859460 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 32.17807 </td>
   <td style="text-align:center;"> 32.21407 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 32.19607 </td>
   <td style="text-align:center;"> 0.6110752 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 33.54650 </td>
   <td style="text-align:center;"> 33.58250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.56450 </td>
   <td style="text-align:center;"> 0.4629314 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
   <td style="text-align:center;"> 40.54381 </td>
   <td style="text-align:center;"> 40.57981 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 40.56181 </td>
   <td style="text-align:center;"> 0.6068854 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 8 </td>
   <td style="text-align:center;"> 42.25833 </td>
   <td style="text-align:center;"> 42.29433 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 42.27633 </td>
   <td style="text-align:center;"> 0.7280403 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 18.55341 </td>
   <td style="text-align:center;"> 18.58941 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 18.57141 </td>
   <td style="text-align:center;"> 0.5914480 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 23.91575 </td>
   <td style="text-align:center;"> 23.95175 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 23.93375 </td>
   <td style="text-align:center;"> 0.8918387 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch2.wav </td>
   <td style="text-align:center;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 27.89376 </td>
   <td style="text-align:center;"> 27.92976 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 27.91176 </td>
   <td style="text-align:center;"> 0.4598352 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 28.22791 </td>
   <td style="text-align:center;"> 28.26391 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 28.24591 </td>
   <td style="text-align:center;"> 0.4859460 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 32.17807 </td>
   <td style="text-align:center;"> 32.21407 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 32.19607 </td>
   <td style="text-align:center;"> 0.6110752 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 33.54650 </td>
   <td style="text-align:center;"> 33.58250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.56450 </td>
   <td style="text-align:center;"> 0.4629314 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
   <td style="text-align:center;"> 40.54381 </td>
   <td style="text-align:center;"> 40.57981 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 40.56181 </td>
   <td style="text-align:center;"> 0.6068854 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch4.wav </td>
   <td style="text-align:center;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 8 </td>
   <td style="text-align:center;"> 42.25833 </td>
   <td style="text-align:center;"> 42.29433 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 42.27633 </td>
   <td style="text-align:center;"> 0.7280403 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 1_ch3.wav </td>
   <td style="text-align:center;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 24.98930 </td>
   <td style="text-align:center;"> 25.02530 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 25.00730 </td>
   <td style="text-align:center;"> 0.6983542 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 26.59241 </td>
   <td style="text-align:center;"> 26.62841 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 26.61041 </td>
   <td style="text-align:center;"> 0.7479324 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 30.00148 </td>
   <td style="text-align:center;"> 30.03748 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 30.01948 </td>
   <td style="text-align:center;"> 0.5576180 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 33.71686 </td>
   <td style="text-align:center;"> 33.75286 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.73486 </td>
   <td style="text-align:center;"> 0.8860906 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 37.74650 </td>
   <td style="text-align:center;"> 37.78250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 37.76450 </td>
   <td style="text-align:center;"> 0.6860341 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 39.30186 </td>
   <td style="text-align:center;"> 39.33786 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 39.31986 </td>
   <td style="text-align:center;"> 0.8321235 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 14 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 24.98930 </td>
   <td style="text-align:center;"> 25.02530 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 25.00730 </td>
   <td style="text-align:center;"> 0.6983542 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 26.59241 </td>
   <td style="text-align:center;"> 26.62841 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 26.61041 </td>
   <td style="text-align:center;"> 0.7479324 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 30.00148 </td>
   <td style="text-align:center;"> 30.03748 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 30.01948 </td>
   <td style="text-align:center;"> 0.5576180 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 33.71686 </td>
   <td style="text-align:center;"> 33.75286 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.73486 </td>
   <td style="text-align:center;"> 0.8860906 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 37.74650 </td>
   <td style="text-align:center;"> 37.78250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 37.76450 </td>
   <td style="text-align:center;"> 0.6860341 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 39.30186 </td>
   <td style="text-align:center;"> 39.33786 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 39.31986 </td>
   <td style="text-align:center;"> 0.8321235 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 14 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 24.98930 </td>
   <td style="text-align:center;"> 25.02530 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 25.00730 </td>
   <td style="text-align:center;"> 0.6983542 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 26.59241 </td>
   <td style="text-align:center;"> 26.62841 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 26.61041 </td>
   <td style="text-align:center;"> 0.7479324 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 3 </td>
   <td style="text-align:center;"> 30.00148 </td>
   <td style="text-align:center;"> 30.03748 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 30.01948 </td>
   <td style="text-align:center;"> 0.5576180 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 11 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 4 </td>
   <td style="text-align:center;"> 33.71686 </td>
   <td style="text-align:center;"> 33.75286 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 33.73486 </td>
   <td style="text-align:center;"> 0.8860906 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 5 </td>
   <td style="text-align:center;"> 37.74650 </td>
   <td style="text-align:center;"> 37.78250 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 37.76450 </td>
   <td style="text-align:center;"> 0.6860341 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch2.wav </td>
   <td style="text-align:center;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 6 </td>
   <td style="text-align:center;"> 39.30186 </td>
   <td style="text-align:center;"> 39.33786 </td>
   <td style="text-align:center;"> 2_ch2.wav-2 </td>
   <td style="text-align:center;"> 39.31986 </td>
   <td style="text-align:center;"> 0.8321235 </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 2_ch1.wav </td>
   <td style="text-align:center;"> 14 </td>
  </tr>
</tbody>
</table></div>
<p>Now we just need to choose the selection with the highest cross-correlation score (&lsquo;dup_peaks$score&rsquo;) for each group of overlapping selections:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># find highest score selection</span>
</span></span><span class="line"><span class="cl"><span class="n">detections</span> <span class="o">&lt;-</span> <span class="n">dup_peaks</span><span class="nf">[ave</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">dup_peaks</span><span class="o">$</span><span class="n">score</span><span class="p">,</span> <span class="n">dup_peaks</span><span class="o">$</span><span class="n">ovlp.sels</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">FUN</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="nf">rank</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ties.method</span> <span class="o">=</span> <span class="s">&#34;first&#34;</span><span class="p">))</span> <span class="o">==</span> <span class="m">1</span><span class="p">,</span> <span class="n">]</span>
</span></span></code></pre></div><p>We can look again at the remaining detections. Now we are not intersted in detetions for individual channels but rather for each of the two recording event. So we can just plot all detections on the first channel for each sound file. To do this we must modify the sound file name like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># change channel to 1</span>
</span></span><span class="line"><span class="cl"><span class="n">detections</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;ch[[:digit:]]&#34;</span><span class="p">,</span> <span class="s">&#34;ch1&#34;</span><span class="p">,</span> <span class="n">detections</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">lspec</span><span class="p">(</span><span class="n">detections</span><span class="p">,</span> <span class="n">sxrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">      <span class="n">fast.spec</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  
      
      
  <picture>
  <img class="img-fluid" src="marce10.github.io/coded_bioacustics/img/detections_lspec.gif?v=a7c2ff2f1a2bfd9f0fa31959dda222f6" alt="gif3" loading="lazy" height="595px" width="770px" />
</picture>
</p>
<p>Overall it looks OK, but some signals were not detected. This could be fixed by decreasing the correlation threshold. Alternatively, we could use several templates that better represent the variation in call structure. If taking the second approach, the same trick can be used for excluding duplicated detections (removing overlapping detections using <code>ovlp_sels()</code>).</p>
<h2 id="amplitude-threshold-based-detection">Amplitude threshold based detection</h2>
<p>Amplitude detectors can be an useful alternative to cross-correlation. These detectors don&rsquo;t require highly stereotyped signals, although they work better on high quality recordings in which the amplitude of target signals is higher than background noise (i.e. high signal-to-noise ratio). The function <code>auto_detec()</code> performs this type of detection. In this case we use the initial selection table to detect inquiry calls. The first 1.5 s of the recordings are excluded to get rid of a very loud clap at the beginning of sound files:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># remove clap </span>
</span></span><span class="line"><span class="cl"><span class="n">sel_tab_1</span><span class="o">$</span><span class="n">start</span> <span class="o">&lt;-</span> <span class="m">1.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># detect</span>
</span></span><span class="line"><span class="cl"><span class="n">ad</span> <span class="o">&lt;-</span> <span class="nf">auto_detec</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">sel_tab_1</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="m">30</span><span class="p">,</span> <span class="n">ssmooth</span> <span class="o">=</span> <span class="m">700</span><span class="p">,</span> <span class="n">mindur</span> <span class="o">=</span> <span class="m">0.005</span><span class="p">,</span> <span class="n">wl</span> <span class="o">=</span> <span class="m">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">maxdur</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> <span class="n">bp</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="n">output</span> <span class="o">=</span> <span class="s">&#34;list&#34;</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><p>Note that we also used time filters (&lsquo;mindur&rsquo; and &lsquo;maxdur&rsquo;) and a bandpass filter (&lsquo;bp&rsquo;). This are set based on our previous knowledge of the target signal duration and frequency range. The argument <code>output = &quot;list&quot;</code> generates an R object that can be taken by <code>lspec()</code>, similarly as in previous examples. This is how the detection looks like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">lspec</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">sxrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="n">rows</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">fast.spec</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  
      
      
  <picture>
  <img class="img-fluid" src="marce10.github.io/coded_bioacustics/img/autodetec_lspec.gif?v=e72016ca9a588179c71d2e3442eabe59" alt="gif4" loading="lazy" height="649px" width="840px" />
</picture>
</p>
<p>Again, we need to remove duplicated detection. In this case there are no correlation scores so we just simply find the overlapping detections and remove the duplicated ones:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># extract selection table from find_peaks output</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_ad</span> <span class="o">&lt;-</span> <span class="n">ad</span><span class="o">$</span><span class="n">selection.table</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># rename sound files column so all channels belonging to the </span>
</span></span><span class="line"><span class="cl"><span class="c1"># same sound file have the same sound file name momentarily</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_ad</span><span class="o">$</span><span class="n">org.sound.files</span> <span class="o">&lt;-</span> <span class="n">dup_ad</span><span class="o">$</span><span class="n">sound.files</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_ad</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;_ch[[:digit:]]&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">dup_ad</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get overlapping sels</span>
</span></span><span class="line"><span class="cl"><span class="n">dup_ad</span> <span class="o">&lt;-</span> <span class="nf">ovlp_sels</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">dup_ad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># remove duplicaets</span>
</span></span><span class="line"><span class="cl"><span class="n">ad_detections</span> <span class="o">&lt;-</span> <span class="n">dup_ad[</span><span class="o">!</span><span class="nf">duplicated</span><span class="p">(</span><span class="n">dup_ad</span><span class="o">$</span><span class="n">ovlp.sels</span><span class="p">,</span> <span class="n">incomparables</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">),</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get original sound files names back  </span>
</span></span><span class="line"><span class="cl"><span class="n">ad_detections</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="n">ad_detections</span><span class="o">$</span><span class="n">org.sound.files</span>
</span></span></code></pre></div><p>We can now look at the remaining detections. We need to modify the sound file name so they are all plotted on the first channel:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># change channel to 1</span>
</span></span><span class="line"><span class="cl"><span class="n">ad_detections</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;ch[[:digit:]]&#34;</span><span class="p">,</span> <span class="s">&#34;ch1&#34;</span><span class="p">,</span> <span class="n">ad_detections</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">lspec</span><span class="p">(</span><span class="n">ad_detections</span><span class="p">,</span> <span class="n">sxrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">flim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">      <span class="n">fast.spec</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















  
  </p>
<p>Most calls were detected but not all of them. This detection could improve by adjusting the detection parameters (i.e. &rsquo;threshold&rsquo;, &lsquo;ssmooth&rsquo;, etc). Nonetheless, the example is good enough to show how to do these analyses in R.</p>
<hr>
<p><font size="4">Session information</font></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1">## R version 3.6.1 (2019-07-05)</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Running under: Ubuntu 18.04.4 LTS</span>
</span></span><span class="line"><span class="cl"><span class="c1">## </span>
</span></span><span class="line"><span class="cl"><span class="c1">## Matrix products: default</span>
</span></span><span class="line"><span class="cl"><span class="c1">## BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3</span>
</span></span><span class="line"><span class="cl"><span class="c1">## LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3</span>
</span></span><span class="line"><span class="cl"><span class="c1">## </span>
</span></span><span class="line"><span class="cl"><span class="c1">## locale:</span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       </span>
</span></span><span class="line"><span class="cl"><span class="c1">## </span>
</span></span><span class="line"><span class="cl"><span class="c1">## attached base packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">## [1] stats     graphics  grDevices utils     datasets </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [6] methods   base     </span>
</span></span><span class="line"><span class="cl"><span class="c1">## </span>
</span></span><span class="line"><span class="cl"><span class="c1">## other attached packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">## [1] kableExtra_1.1.0   warbleR_1.1.24     NatureSounds_1.0.3</span>
</span></span><span class="line"><span class="cl"><span class="c1">## [4] seewave_2.1.6      tuneR_1.3.3        knitr_1.28        </span>
</span></span><span class="line"><span class="cl"><span class="c1">## </span>
</span></span><span class="line"><span class="cl"><span class="c1">## loaded via a namespace (and not attached):</span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [1] Rcpp_1.0.4.6      highr_0.8         compiler_3.6.1   </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [4] pillar_1.4.4      bitops_1.0-6      tools_3.6.1      </span>
</span></span><span class="line"><span class="cl"><span class="c1">##  [7] digest_0.6.25     viridisLite_0.3.0 evaluate_0.14    </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [10] tibble_3.0.1      lifecycle_0.2.0   fftw_1.0-6       </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [13] pkgconfig_2.0.3   rlang_0.4.6       rstudioapi_0.11  </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [16] yaml_2.2.1        parallel_3.6.1    xfun_0.14        </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [19] xml2_1.3.2        stringr_1.4.0     httr_1.4.1       </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [22] vctrs_0.3.1       hms_0.5.3         webshot_0.5.2    </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [25] glue_1.4.1        R6_2.4.1          dtw_1.21-3       </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [28] pbapply_1.4-2     rmarkdown_2.2     readr_1.3.1      </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [31] magrittr_1.5      scales_1.1.1      htmltools_0.4.0  </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [34] ellipsis_0.3.1    MASS_7.3-51.4     rvest_0.3.5      </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [37] colorspace_1.4-1  stringi_1.4.6     proxy_0.4-24     </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [40] munsell_0.5.0     signal_0.7-6      RCurl_1.98-1.2   </span>
</span></span><span class="line"><span class="cl"><span class="c1">## [43] crayon_1.3.4      rjson_0.2.20</span>
</span></span></code></pre></div>

        
          <div class="blog-tags">
            
              <a href="marce10.github.io/coded_bioacustics//tags/sound-event-detection/">sound event detection</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f&amp;text=Automatic%20signal%20detection%3a%20a%20case%20study&amp;via=Marcelo_Araya_Salas" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f&amp;title=Automatic%20signal%20detection%3a%20a%20case%20study" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f&amp;title=Automatic%20signal%20detection%3a%20a%20case%20study" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f&amp;title=Automatic%20signal%20detection%3a%20a%20case%20study" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2020-06-15-automatic_signal_detection_a_case_study%2f&amp;description=Automatic%20signal%20detection%3a%20a%20case%20study" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2016-12-15-detecting_signals_with_monitor/">Signal detection with cross-correlation using monitoR </a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="marce10.github.io/coded_bioacustics/post/2020-03-15-leaflet_xcmaps/" data-toggle="tooltip" data-placement="top" title="Interactive maps from Xeno-Canto recording localities in xc_maps()">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="marce10.github.io/coded_bioacustics/post/2020-05-26-editing_wave_objects_from_extended_selection_tables/" data-toggle="tooltip" data-placement="top" title="Editing wave objects from extended selection tables">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          
          <div class="disqus-comments">                  
            <button id="show-comments" class="btn btn-default" type="button">Show <span class="disqus-comment-count" data-disqus-url="marce10.github.io/coded_bioacustics/post/2020-06-15-automatic_signal_detection_a_case_study">comments</span></button>
            <div id="disqus_thread"></div>

            <script type="text/javascript">
              var disqus_config = function () {
              this.page.url = 'marce10.github.io\/coded_bioacustics\/post\/2020-06-15-automatic_signal_detection_a_case_study';
            };

          </script>
          </div>
          
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="https://github.com/maRce10" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://twitter.com/Marcelo_Araya_Salas" title="Twitter">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://www.youtube.com/@MrBioacoustics" title="Youtube">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2020
          

          
            &nbsp;&bull;&nbsp;
            <a href="marce10.github.io/coded_bioacustics/">Coded bioacoustics</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.121.2</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="marce10.github.io/coded_bioacustics/js/main.js"></script>
<script src="marce10.github.io/coded_bioacustics/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="marce10.github.io/coded_bioacustics/js/load-photoswipe.js"></script>








<script type="text/javascript">
$(function(){
  $('#show-comments').on('click', function(){
    var disqus_shortname = 'maRce_10';
      
    (function() {
      var disqus = document.createElement('script'); 
      disqus.type = 'text/javascript'; 
      disqus.async = true;
      disqus.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(disqus);
    })();
      
    $(this).hide(); 
    });
  });
      
</script>
<script id="dsq-count-scr" src="//maRce_10.disqus.com/count.js" async></script>




    
  </body>
</html>

