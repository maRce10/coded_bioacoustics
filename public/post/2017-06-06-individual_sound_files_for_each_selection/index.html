<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Individual sound files for each selection - Coded bioacoustics</title>

  <meta name="description" content="A friend of mine wants to &ldquo;create individual sound files for each selection&rdquo; in a selection table. This is a good opportunity to show how to create a function that works iteratively on signals in a selection table (like most warbleR functions).
It takes 3 main steps:
Create a (internal) function that does what we want on a single selection (i.e. a single row of the selection table)
Add and (X)lapply loop to run the function from step 1 iteratively on each row"><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Coded bioacoustics",
    
    "url": "marce10.github.io\/coded_bioacustics\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "marce10.github.io\/coded_bioacustics\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "marce10.github.io\/coded_bioacustics\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "marce10.github.io\/coded_bioacustics\/post\/2017-06-06-individual_sound_files_for_each_selection\/",
          "name": "Individual sound files for each selection"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Marcelo Araya-Salas"
  },
  "headline": "Individual sound files for each selection",
  "description" : "A friend of mine wants to \u0026ldquo;create individual sound files for each selection\u0026rdquo; in a selection table. This is a good opportunity to show how to create a function that works iteratively on signals in a selection table (like most warbleR functions).\nIt takes 3 main steps:\nCreate a (internal) function that does what we want on a single selection (i.e. a single row of the selection table)\nAdd and (X)lapply loop to run the function from step 1 iteratively on each row",
  "inLanguage" : "en",
  "wordCount":  1726 ,
  "datePublished" : "2017-06-06T00:00:00",
  "dateModified" : "2017-06-06T00:00:00",
  "image" : "marce10.github.io\/coded_bioacustics\/img\/blog_sticker_v2.png",
  "keywords" : [ "annotations, R" ],
  "mainEntityOfPage" : "marce10.github.io\/coded_bioacustics\/post\/2017-06-06-individual_sound_files_for_each_selection\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "marce10.github.io\/coded_bioacustics\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "marce10.github.io\/coded_bioacustics\/img\/blog_sticker_v2.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Individual sound files for each selection" />
<meta property="og:description" content="A friend of mine wants to &ldquo;create individual sound files for each selection&rdquo; in a selection table. This is a good opportunity to show how to create a function that works iteratively on signals in a selection table (like most warbleR functions).
It takes 3 main steps:
Create a (internal) function that does what we want on a single selection (i.e. a single row of the selection table)
Add and (X)lapply loop to run the function from step 1 iteratively on each row">
<meta property="og:image" content="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" />
<meta property="og:url" content="marce10.github.io/coded_bioacustics/marce10.github.io/coded_bioacustics/post/2017-06-06-individual_sound_files_for_each_selection/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Coded bioacoustics" />

  <meta name="twitter:title" content="Individual sound files for each selection" />
  <meta name="twitter:description" content="A friend of mine wants to &ldquo;create individual sound files for each selection&rdquo; in a selection table. This is a good opportunity to show how to create a function that works iteratively on â€¦">
  <meta name="twitter:image" content="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@Marcelo_Araya_Salas" />
  <meta name="twitter:creator" content="@Marcelo_Araya_Salas" />
  <link href='marce10.github.io/coded_bioacustics/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.121.2">
  <link rel="alternate" href="marce10.github.io/coded_bioacustics/index.xml" type="application/rss+xml" title="Coded bioacoustics"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/highlight.min.css" /><link rel="stylesheet" href="marce10.github.io/coded_bioacustics/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-RZVLSR0L9P"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-RZVLSR0L9P', { 'anonymize_ip': false });
}
</script>

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="marce10.github.io/coded_bioacustics/">Coded bioacoustics</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Useful resources</a>
              <div class="navlinks-children">
                
                  <a href="https://github.com/rhine3/bioacoustics-software">Bioacoustics software list</a>
                
                  <a href="https://bioacoustics.stackexchange.com/">Bioacoustics StackExcange forum</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/marce10.github.io/coded_bioacustics/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/marce10.github.io/coded_bioacustics/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Coded bioacoustics" href="marce10.github.io/coded_bioacustics/">
            <img class="avatar-img" src="marce10.github.io/coded_bioacustics/img/blog_sticker_v2.png" alt="Coded bioacoustics" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Individual sound files for each selection</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on June 6, 2017
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;9&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1726&nbsp;words
  
  
    
      
        &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Marcelo Araya-Salas
      
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>A friend of mine wants to &ldquo;create individual sound files for each selection&rdquo; in a selection table. This is a good opportunity to show how to create a function that works iteratively on signals in a selection table (like most <a href="https://cran.r-project.org/package=warbleR">warbleR</a> functions).</p>
<p>It takes 3 main steps:</p>
<ol>
<li>
<p>Create a (internal) function that does what we want on a single selection (i.e. a single row of the selection table)</p>
</li>
<li>
<p>Add and <code>(X)lapply</code> loop to run the function from step 1 iteratively on each row</p>
</li>
<li>
<p>Put all inside a new function</p>
</li>
</ol>
<p>Other things can be added to the function to check arguments and set working directory, but this is not critical.</p>
<h3 id="step-1-create-function-that-does-what-we-want-on-a-single-selection">Step 1: Create function that does what we want on a single selection</h3>
<p>First install and/or load <a href="https://cran.r-project.org/package=warbleR">warbleR</a> (which also loads <a href="https://cran.r-project.org/package=tuneR">tuneR</a>, the package for cutting and saving sound files):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="s">&#34;devtools&#34;</span> <span class="o">%in%</span> <span class="nf">installed.packages</span><span class="p">()</span><span class="n">[</span><span class="p">,</span><span class="s">&#34;Package&#34;</span><span class="n">]</span><span class="p">)</span>  <span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;devtools&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">require</span><span class="p">(</span><span class="s">&#34;devtools&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&#34;maRce10/warbleR&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">require</span><span class="p">(</span><span class="s">&#34;warbleR&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Save the example sound files as <em>.wav</em> in a temporary working directory (to test the code):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">setwd</span><span class="p">(</span><span class="nf">tempdir</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">data</span><span class="p">(</span><span class="n">list</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Phae.long1&#34;</span><span class="p">,</span> <span class="s">&#34;Phae.long2&#34;</span><span class="p">,</span> <span class="s">&#34;Phae.long3&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">              <span class="s">&#34;Phae.long4&#34;</span><span class="p">,</span> <span class="s">&#34;selec.table&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">writeWave</span><span class="p">(</span><span class="n">Phae.long1</span><span class="p">,</span><span class="s">&#34;Phae.long1.wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">writeWave</span><span class="p">(</span><span class="n">Phae.long2</span><span class="p">,</span><span class="s">&#34;Phae.long2.wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">writeWave</span><span class="p">(</span><span class="n">Phae.long3</span><span class="p">,</span><span class="s">&#34;Phae.long3.wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">writeWave</span><span class="p">(</span><span class="n">Phae.long4</span><span class="p">,</span><span class="s">&#34;Phae.long4.wav&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>We can check that now there are 4 sound files in the working directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;Phae.long1.wav&#34; &#34;Phae.long2.wav&#34; &#34;Phae.long3.wav&#34; &#34;Phae.long4.wav&#34;
</span></span></code></pre></div><p>The selection table <code>selec.table</code> contains columns for sound file name, start and end of signals (in seconds), and a unique ID for each selection:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">selec.table</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##      sound.files channel selec     start       end bottom.freq top.freq
</span></span><span class="line"><span class="cl">## 1 Phae.long1.wav       1     1 1.1693549 1.3423884    2.220105 8.604378
</span></span><span class="line"><span class="cl">## 2 Phae.long1.wav       1     2 2.1584085 2.3214565    2.169437 8.807053
</span></span><span class="line"><span class="cl">## 3 Phae.long1.wav       1     3 0.3433366 0.5182553    2.218294 8.756604
</span></span><span class="line"><span class="cl">## 4 Phae.long2.wav       1     1 0.1595983 0.2921692    2.316862 8.822316
</span></span><span class="line"><span class="cl">## 5 Phae.long2.wav       1     2 1.4570585 1.5832087    2.284006 8.888027
</span></span><span class="line"><span class="cl">## 6 Phae.long3.wav       1     1 0.6265520 0.7577715    3.006834 8.822316
</span></span><span class="line"><span class="cl">##   sel.comment rec.comment
</span></span><span class="line"><span class="cl">## 1         c24          NA
</span></span><span class="line"><span class="cl">## 2         c25          NA
</span></span><span class="line"><span class="cl">## 3         c26          NA
</span></span><span class="line"><span class="cl">## 4         c27          NA
</span></span><span class="line"><span class="cl">## 5         c28          NA
</span></span><span class="line"><span class="cl">## 6         c29          NA
</span></span></code></pre></div><p>Now write a code that takes the selection from a single row, extracts the <em>.wav</em> file segment, and save it to the working directory. To do this use the functions <code>readWave</code> and <code>writeWave</code> from <a href="https://cran.r-project.org/package=tuneR">tuneR</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1">#lets use X for the selection table data frame as is the convention in warbleR functions </span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">&lt;-</span> <span class="n">selec.table</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cut wave for the first row</span>
</span></span><span class="line"><span class="cl"><span class="n">wvcut</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[1]</span><span class="p">),</span> <span class="n">from</span> <span class="o">=</span> <span class="n">X</span><span class="o">$</span><span class="n">start[1]</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">X</span><span class="o">$</span><span class="n">end[1]</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;seconds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># save cut removing file extension</span>
</span></span><span class="line"><span class="cl"><span class="n">tuneR</span><span class="o">::</span><span class="nf">writeWave</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">wvcut</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[1]</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">selec[1]</span><span class="p">,</span> <span class="s">&#34;.wav&#34;</span><span class="p">))</span>
</span></span></code></pre></div><p>Note that the sound file name (with the file extension removed) and selection ID were used to name the cut. This is important because it will produce a unique name for each cut, so they won&rsquo;t be overwritten.</p>
<p>The following code shows that there is a new sound file corresponding to the new cut:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;Phae.long1-1.wav&#34; &#34;Phae.long1.wav&#34;   &#34;Phae.long2.wav&#34;  
</span></span><span class="line"><span class="cl">## [4] &#34;Phae.long3.wav&#34;   &#34;Phae.long4.wav&#34;
</span></span></code></pre></div><p>Now put the code inside a function. The index number 1 used above has to be replaced by &lsquo;i&rsquo; so it runs one each row iteratively. I also added a few more line of codes to:</p>
<ul>
<li>Allow adding margins at both sides of the signals</li>
<li>Adjust the start and end when the margin surpasses the start (0) and end of the whole sound file</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">cutFUN</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Read sound files, initialize frequency and time limits for spectrogram</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">sample.rate</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">start[i]</span> <span class="o">-</span> <span class="n">mar</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">+</span> <span class="n">mar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># fix margins if below 0 or length of recordings</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar1</span> <span class="o">&lt;-</span> <span class="n">mar</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar2</span> <span class="o">&lt;-</span> <span class="n">mar1</span> <span class="o">+</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">-</span> <span class="n">X</span><span class="o">$</span><span class="n">start[i]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">if</span> <span class="p">(</span><span class="n">t[1]</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span>  <span class="n">t[1]</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">t[2]</span> <span class="o">&gt;</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="n">t[2]</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Cut wave</span>
</span></span><span class="line"><span class="cl">    <span class="n">wvcut</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">from</span> <span class="o">=</span> <span class="n">t[1]</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">t[2]</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;seconds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tuneR</span><span class="o">::</span><span class="nf">writeWave</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">wvcut</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">selec[i]</span><span class="p">,</span> <span class="s">&#34;.wav&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><h3 id="step-2-add-a-ixlapplyi-function">Step 2: Add a <!-- raw HTML omitted -->(X)lapply<!-- raw HTML omitted --> function</h3>
<p>Several versions of the <code>lapply</code> function can be used. The function <code>pblapply</code> from the package <a href="https://cran.r-project.org/package=pbapply">pbapply</a> provides a nice progress bar. The following code should produce cuts for each selection in <code>selec.table</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">out</span> <span class="o">&lt;-</span> <span class="n">pbapply</span><span class="o">::</span><span class="nf">pblapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">selec.table</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">selec.table</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">))</span>
</span></span></code></pre></div><p>We could also used <code>lapply</code> (no progress bar) or <code>mclapply</code> ([parallel] package, parallel computing), or even <code>pbmclapply</code> (<a href="https://cran.r-project.org/package=pbmcapply">pbmcapply</a> package, parallel computing and progress bar, but not available for windows). In fact, all these options are included in most <a href="https://cran.r-project.org/package=warbleR">warbleR</a> functions.</p>
<h3 id="step-3-put-all-the-code-inside-a-new-function">Step 3: Put all the code inside a new function</h3>
<p>Just copy/paste the <code>cutFUN</code> function and the <code>(X)lapply</code> function inside a new function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">cut.selections</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mar</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># internal function to cut each selection </span>
</span></span><span class="line"><span class="cl"><span class="n">cutFUN</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Read sound files, initialize frequency and time limits for spectrogram</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">sample.rate</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">start[i]</span> <span class="o">-</span> <span class="n">mar</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">+</span> <span class="n">mar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># fix margins if below 0 or length of recordings</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar1</span> <span class="o">&lt;-</span> <span class="n">mar</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar2</span> <span class="o">&lt;-</span> <span class="n">mar1</span> <span class="o">+</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">-</span> <span class="n">X</span><span class="o">$</span><span class="n">start[i]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">if</span> <span class="p">(</span><span class="n">t[1]</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span>  <span class="n">t[1]</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">t[2]</span> <span class="o">&gt;</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="n">t[2]</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Cut wave</span>
</span></span><span class="line"><span class="cl">    <span class="n">wvcut</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">from</span> <span class="o">=</span> <span class="n">t[1]</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">t[2]</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;seconds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tuneR</span><span class="o">::</span><span class="nf">writeWave</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">wvcut</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">selec[i]</span><span class="p">,</span> <span class="s">&#34;.wav&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># lapply function to run over all selections  </span>
</span></span><span class="line"><span class="cl"><span class="n">out</span> <span class="o">&lt;-</span> <span class="n">pbapply</span><span class="o">::</span><span class="nf">pblapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">selec.table</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Let&rsquo;s see if it works. First we should remove the cuts we created previously. The following code removes only the cuts but not the original sound files (filtered out based on file size):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">wvs</span> <span class="o">&lt;-</span> <span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sz</span> <span class="o">&lt;-</span> <span class="nf">file.info</span><span class="p">(</span><span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span><span class="o">$</span><span class="n">size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">unlink</span><span class="p">(</span><span class="n">wvs[sz</span> <span class="o">&lt;</span> <span class="m">50000</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## [1] &#34;Phae.long1.wav&#34; &#34;Phae.long2.wav&#34; &#34;Phae.long3.wav&#34; &#34;Phae.long4.wav&#34;
</span></span></code></pre></div><p>And run the function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">cut.selections</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">selec.table</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">)</span>
</span></span></code></pre></div><p>The cuts now are found in the working directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">##  [1] &#34;Phae.long1.wav&#34;       &#34;Phae.long1.wav-1.wav&#34; &#34;Phae.long1.wav-2.wav&#34;
</span></span><span class="line"><span class="cl">##  [4] &#34;Phae.long1.wav-3.wav&#34; &#34;Phae.long2.wav&#34;       &#34;Phae.long2.wav-1.wav&#34;
</span></span><span class="line"><span class="cl">##  [7] &#34;Phae.long2.wav-2.wav&#34; &#34;Phae.long3.wav&#34;       &#34;Phae.long3.wav-1.wav&#34;
</span></span><span class="line"><span class="cl">## [10] &#34;Phae.long3.wav-2.wav&#34; &#34;Phae.long3.wav-3.wav&#34; &#34;Phae.long4.wav&#34;      
</span></span><span class="line"><span class="cl">## [13] &#34;Phae.long4.wav-1.wav&#34; &#34;Phae.long4.wav-2.wav&#34; &#34;Phae.long4.wav-3.wav&#34;
</span></span></code></pre></div><p>I put together all the code in a new <a href="https://cran.r-project.org/package=warbleR">warbleR</a> function called <code>cut_sels</code> (available in version 1.1.9, currrently only on github).  I added a few more arguments (labels, overwrite, parallel, &hellip;), some argument checks to warn users when using invalid values, and parallel and progress bar options. Here is the code in case you are curious:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">cut_sels</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> <span class="n">parallel</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sound.files&#34;</span><span class="p">,</span> <span class="s">&#34;selec&#34;</span><span class="p">),</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="kc">...</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#check path to working directory</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span><span class="n">wd</span> <span class="o">&lt;-</span> <span class="nf">getwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="nf">try</span><span class="p">(</span><span class="nf">setwd</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">silent</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="o">==</span> <span class="s">&#34;try-error&#34;</span><span class="p">)</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;path&#39; provided does not exist&#34;</span><span class="p">)</span> <span class="kr">else</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">setwd</span><span class="p">(</span><span class="n">path</span><span class="p">)}</span> <span class="c1">#set working directory</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#check path to working directory</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">dest.path</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span><span class="kr">if</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="nf">try</span><span class="p">(</span><span class="nf">setwd</span><span class="p">(</span><span class="n">dest.path</span><span class="p">),</span> <span class="n">silent</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="o">==</span> <span class="s">&#34;try-error&#34;</span><span class="p">)</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;dest.path&#39; provided does not exist&#34;</span><span class="p">)}</span> <span class="kr">else</span> <span class="n">dest.path</span> <span class="o">&lt;-</span> <span class="nf">getwd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#set working directory</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#if X is not a data frame</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">class</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#34;data.frame&#34;</span><span class="p">)</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;X is not a data frame&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;sound.files&#34;</span><span class="p">,</span> <span class="s">&#34;selec&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">            <span class="s">&#34;start&#34;</span><span class="p">,</span> <span class="s">&#34;end&#34;</span><span class="p">)</span> <span class="o">%in%</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">stop</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;sound.files&#34;</span><span class="p">,</span> <span class="s">&#34;selec&#34;</span><span class="p">,</span> <span class="s">&#34;start&#34;</span><span class="p">,</span> <span class="s">&#34;end&#34;</span><span class="p">)</span><span class="n">[</span><span class="o">!</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;sound.files&#34;</span><span class="p">,</span> <span class="s">&#34;selec&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                                                   <span class="s">&#34;start&#34;</span><span class="p">,</span> <span class="s">&#34;end&#34;</span><span class="p">)</span> <span class="o">%in%</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="n">]</span><span class="p">,</span> <span class="n">collapse</span><span class="o">=</span><span class="s">&#34;, &#34;</span><span class="p">),</span> <span class="s">&#34;column(s) not found in data frame&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#if there are NAs in start or end stop</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">any</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">end</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">start</span><span class="p">))))</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;NAs found in start and/or end&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#if end or start are not numeric stop</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">all</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">end</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#34;numeric&#34;</span> <span class="o">&amp;</span> <span class="nf">class</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">start</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#34;numeric&#34;</span><span class="p">))</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;end&#39; and &#39;selec&#39; must be numeric&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#if any start higher than end stop</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">any</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">end</span> <span class="o">-</span> <span class="n">X</span><span class="o">$</span><span class="n">start</span><span class="o">&lt;</span><span class="m">0</span><span class="p">))</span> <span class="nf">stop</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;The start is higher than the end in&#34;</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="nf">which</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">end</span> <span class="o">-</span> <span class="n">X</span><span class="o">$</span><span class="n">start</span><span class="o">&lt;</span><span class="m">0</span><span class="p">)),</span> <span class="s">&#34;case(s)&#34;</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#return warning if not all sound files were found</span>
</span></span><span class="line"><span class="cl">  <span class="n">recs.wd</span> <span class="o">&lt;-</span> <span class="nf">list.files</span><span class="p">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span><span class="nf">[</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">%in%</span> <span class="n">recs.wd</span><span class="p">)</span><span class="n">]</span><span class="p">))</span> <span class="o">!=</span> <span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span><span class="p">)))</span> 
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span><span class="p">))</span><span class="o">-</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span><span class="nf">[</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">%in%</span> <span class="n">recs.wd</span><span class="p">)</span><span class="n">]</span><span class="p">)),</span> 
</span></span><span class="line"><span class="cl">           <span class="s">&#34;.wav file(s) not found&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#missing label columns</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="n">labels</span> <span class="o">%in%</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="nf">stop</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">labels[</span><span class="o">!</span><span class="p">(</span><span class="n">labels</span> <span class="o">%in%</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="n">]</span><span class="p">,</span> <span class="n">collapse</span><span class="o">=</span><span class="s">&#34;, &#34;</span><span class="p">),</span> <span class="s">&#34;label column(s) not found in data frame&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#count number of sound files in working directory and if 0 stop</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">%in%</span> <span class="n">recs.wd</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;The .wav files are not in the working directory&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>  <span class="kr">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">&lt;-</span> <span class="n">X[d</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#convert factors to characters</span>
</span></span><span class="line"><span class="cl">  <span class="n">X[</span><span class="p">,</span><span class="nf">sapply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">is.factor</span><span class="p">)</span><span class="n">]</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">X[</span><span class="p">,</span><span class="nf">sapply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">is.factor</span><span class="p">)</span><span class="n">]</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">as.character</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#remove .wav from sound file names</span>
</span></span><span class="line"><span class="cl">  <span class="n">X2</span> <span class="o">&lt;-</span> <span class="n">X</span>
</span></span><span class="line"><span class="cl">  <span class="n">X2</span><span class="o">$</span><span class="n">sound.files</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#34;\\.wav$&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">X2</span><span class="o">$</span><span class="n">sound.files</span><span class="p">,</span> <span class="n">ignore.case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># If parallel is not numeric</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.numeric</span><span class="p">(</span><span class="n">parallel</span><span class="p">))</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;parallel&#39; must be a numeric vector of length 1&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="nf">any</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">parallel</span> <span class="o">%%</span> <span class="m">1</span> <span class="o">==</span> <span class="m">0</span><span class="p">),</span><span class="n">parallel</span> <span class="o">&lt;</span> <span class="m">1</span><span class="p">))</span> <span class="nf">stop</span><span class="p">(</span><span class="s">&#34;&#39;parallel&#39; should be a positive integer&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#if parallel and pb in windows</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="n">parallel</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="o">&amp;</span>  <span class="n">pb</span> <span class="o">&amp;</span> <span class="nf">Sys.info</span><span class="p">()</span><span class="n">[1]</span> <span class="o">==</span> <span class="s">&#34;Windows&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">message</span><span class="p">(</span><span class="s">&#34;parallel with progress bar is currently not available for windows OS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">message</span><span class="p">(</span><span class="s">&#34;running parallel without progress bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pb</span> <span class="o">&lt;-</span> <span class="kc">FALSE</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#create function to run within Xapply functions downstream     </span>
</span></span><span class="line"><span class="cl">  <span class="n">cutFUN</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Read sound files, initialize frequency and time limits for spectrogram</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">sample.rate</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">start[i]</span> <span class="o">-</span> <span class="n">mar</span><span class="p">,</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">+</span> <span class="n">mar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># fix margins if below 0 or length of recordings</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar1</span> <span class="o">&lt;-</span> <span class="n">mar</span>
</span></span><span class="line"><span class="cl">    <span class="n">mar2</span> <span class="o">&lt;-</span> <span class="n">mar1</span> <span class="o">+</span> <span class="n">X</span><span class="o">$</span><span class="n">end[i]</span> <span class="o">-</span> <span class="n">X</span><span class="o">$</span><span class="n">start[i]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">if</span> <span class="p">(</span><span class="n">t[1]</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span>  <span class="n">t[1]</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">t[2]</span> <span class="o">&gt;</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="n">t[2]</span> <span class="o">&lt;-</span> <span class="n">r</span><span class="o">$</span><span class="n">samples</span><span class="o">/</span><span class="n">f</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Cut wave</span>
</span></span><span class="line"><span class="cl">    <span class="n">wvcut</span> <span class="o">&lt;-</span> <span class="n">tuneR</span><span class="o">::</span><span class="nf">readWave</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">X</span><span class="o">$</span><span class="n">sound.files[i]</span><span class="p">),</span> <span class="n">from</span> <span class="o">=</span> <span class="n">t[1]</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="n">t[2]</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;seconds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># save cut</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">overwrite</span><span class="p">)</span> <span class="nf">unlink</span><span class="p">(</span><span class="nf">file.path</span><span class="p">(</span><span class="n">dest.path</span><span class="p">,</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">X2[i</span><span class="p">,</span> <span class="n">labels]</span><span class="p">,</span> <span class="n">collapse</span> <span class="o">=</span> <span class="s">&#34;-&#34;</span><span class="p">),</span> <span class="s">&#34;.wav&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">tuneR</span><span class="o">::</span><span class="nf">writeWave</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">wvcut</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="nf">file.path</span><span class="p">(</span><span class="n">dest.path</span><span class="p">,</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">X2[i</span><span class="p">,</span> <span class="n">labels]</span><span class="p">,</span> <span class="n">collapse</span> <span class="o">=</span> <span class="s">&#34;-&#34;</span><span class="p">),</span> <span class="s">&#34;.wav&#34;</span><span class="p">)),</span> <span class="kc">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1"># Run parallel in windows</span>
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="n">parallel</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="nf">Sys.info</span><span class="p">()</span><span class="n">[1]</span> <span class="o">==</span> <span class="s">&#34;Windows&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">i</span> <span class="o">&lt;-</span> <span class="kc">NULL</span> <span class="c1">#only to avoid non-declared objects</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">cl</span> <span class="o">&lt;-</span> <span class="n">parallel</span><span class="o">::</span><span class="nf">makeCluster</span><span class="p">(</span><span class="n">parallel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">doParallel</span><span class="o">::</span><span class="nf">registerDoParallel</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">foreach</span><span class="o">::</span><span class="nf">foreach</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">%dopar%</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">parallel</span><span class="o">::</span><span class="nf">stopCluster</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="nf">Sys.info</span><span class="p">()</span><span class="n">[1]</span> <span class="o">==</span> <span class="s">&#34;Linux&#34;</span><span class="p">)</span> <span class="p">{</span>    <span class="c1"># Run parallel in Linux</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="kr">if</span><span class="p">(</span><span class="n">pb</span><span class="p">)</span>       
</span></span><span class="line"><span class="cl">        <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">pbmcapply</span><span class="o">::</span><span class="nf">pbmclapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">mc.cores</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">,</span> <span class="kr">function</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span> <span class="kr">else</span>
</span></span><span class="line"><span class="cl">          <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">parallel</span><span class="o">::</span><span class="nf">mclapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">mc.cores</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">,</span> <span class="kr">function</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">          <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">any</span><span class="p">(</span><span class="nf">Sys.info</span><span class="p">()</span><span class="n">[1]</span> <span class="o">==</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linux&#34;</span><span class="p">,</span> <span class="s">&#34;Windows&#34;</span><span class="p">)))</span> <span class="c1"># parallel in OSX</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cl</span> <span class="o">&lt;-</span> <span class="n">parallel</span><span class="o">::</span><span class="nf">makeForkCluster</span><span class="p">(</span><span class="nf">getOption</span><span class="p">(</span><span class="s">&#34;cl.cores&#34;</span><span class="p">,</span> <span class="n">parallel</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">doParallel</span><span class="o">::</span><span class="nf">registerDoParallel</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">foreach</span><span class="o">::</span><span class="nf">foreach</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">%dopar%</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">parallel</span><span class="o">::</span><span class="nf">stopCluster</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kr">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">if</span><span class="p">(</span><span class="n">pb</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">out</span> <span class="o">&lt;-</span> <span class="n">pbapply</span><span class="o">::</span><span class="nf">pblapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">))</span> <span class="kr">else</span> 
</span></span><span class="line"><span class="cl">        <span class="n">out</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nf">cutFUN</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="n">mar</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dest.path</span> <span class="o">=</span> <span class="n">dest.path</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="nf">setwd</span><span class="p">(</span><span class="n">wd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>That&rsquo;s is it. If you developed a function that you think could be useful to other people we could include it in <a href="https://cran.r-project.org/package=warbleR">warbleR</a>.</p>


        
          <div class="blog-tags">
            
              <a href="marce10.github.io/coded_bioacustics//tags/annotations/">annotations</a>&nbsp;
            
              <a href="marce10.github.io/coded_bioacustics//tags/r/">R</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f&amp;text=Individual%20sound%20files%20for%20each%20selection&amp;via=Marcelo_Araya_Salas" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f&amp;title=Individual%20sound%20files%20for%20each%20selection" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f&amp;title=Individual%20sound%20files%20for%20each%20selection" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f&amp;title=Individual%20sound%20files%20for%20each%20selection" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=marce10.github.io%2fcoded_bioacustics%2fpost%2f2017-06-06-individual_sound_files_for_each_selection%2f&amp;description=Individual%20sound%20files%20for%20each%20selection" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2020-05-28-dynaspec_dynamic_spectrograms_in_r/">dynaSpec: dynamic spectrograms in R</a></li>
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2020-05-26-editing_wave_objects_from_extended_selection_tables/">Editing wave objects from extended selection tables</a></li>
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2020-06-15-automatic_signal_detection_a_case_study/">Automatic signal detection: a case study</a></li>
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2020-03-15-leaflet_xcmaps/">Interactive maps from Xeno-Canto recording localities in xc_maps()</a></li>
                
                    <li><a href="marce10.github.io/coded_bioacustics/post/2020-04-10-signal_detection_warbler_vs_monitor/">Signal detection with cross-correlation using warbleR</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="marce10.github.io/coded_bioacustics/post/2017-04-23-acoustic_space_scatter_plot/" data-toggle="tooltip" data-placement="top" title="Acoustic space scatter plot">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="marce10.github.io/coded_bioacustics/post/2018-02-22-simulating_animal_vocalizations/" data-toggle="tooltip" data-placement="top" title="Simulating animal vocalizations">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'maRce_10';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


          </div>
          
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="https://github.com/maRce10" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://twitter.com/Marcelo_Araya_Salas" title="Twitter">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://stackoverflow.com/users/4178065/marcelo-araya-salas" title="StackOverflow">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://www.youtube.com/@MarRce10" title="Youtube">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2020
          

          
            &nbsp;&bull;&nbsp;
            <a href="marce10.github.io/coded_bioacustics/">Coded bioacoustics</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.121.2</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="marce10.github.io/coded_bioacustics/js/main.js"></script>
<script src="marce10.github.io/coded_bioacustics/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="marce10.github.io/coded_bioacustics/js/load-photoswipe.js"></script>









    
        
  </body>
</html>

